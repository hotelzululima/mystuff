$OpenBSD: patch-deps_npm_node_modules_node-gyp_lib_install_js,v 1.6 2014/09/24 18:17:27 abieber Exp $

Allow building of sub-packages (ie. node-sqlite3) with USE_SYSTRACE
set, also prevents downloading of the node distfile again.

--- deps/npm/node_modules/node-gyp/lib/install.js.orig	Wed Aug 12 10:15:28 2015
+++ deps/npm/node_modules/node-gyp/lib/install.js	Wed Aug 12 10:18:39 2015
@@ -184,7 +184,7 @@ function install (gyp, argv, callback) {
       }
 
       // now download the node tarball
-      var tarPath = gyp.opts['tarball']
+      var tarPath = gyp.opts['tarball'] || '${PREFIX}/lib/node/${DISTFILES}' // Fix for OpenBSD
       var tarballUrl = tarPath ? tarPath : distUrl + '/v' + version + '/node-v' + version + '.tar.gz'
         , badDownload = false
         , extractCount = 0
